# CHROMATIC_PROJECT_TOKEN=


export PG_DATABASE_URL="postgres://main:main@database.internal:5432/main?connection_limit=1"

export FRONT_BASE_URL=$(echo $PLATFORM_ROUTES | base64 --decode | jq -r 'to_entries[] | select(.value.primary == false and .value.type=="upstream") | .key')

# The following variables are used to generate the secrets
# The secrets are per environment and are used to sign the tokens
# But constant through the project life-cycle (same environment name will have the same secrets)
hash_with_entropy() {
    local input_string="$1${PLATFORM_PROJECT_ENTROPY}${PLATFORM_BRANCH}"
    echo -n "$input_string" | sha1sum | sed 's/ .*$//'
}

export ACCESS_TOKEN_SECRET=$(hash_with_entropy access_token)
export LOGIN_TOKEN_SECRET=$(hash_with_entropy login_token)
export REFRESH_TOKEN_SECRET=$(hash_with_entropy refresh_token)
export SIGN_IN_PREFILLED=true

# ———————— Optional ————————
export DEBUG_MODE=true
# ACCESS_TOKEN_EXPIRES_IN=30m
# LOGIN_TOKEN_EXPIRES_IN=15m
# REFRESH_TOKEN_EXPIRES_IN=90d 
# FRONT_AUTH_CALLBACK_URL=http://localhost:3001/verify 
# AUTH_GOOGLE_ENABLED=false
export STORAGE_TYPE=local
export STORAGE_LOCAL_PATH=.local-storage
# SUPPORT_DRIVER=front
# SUPPORT_FRONT_HMAC_KEY=replace_me_with_front_chat_verification_secret
# SUPPORT_FRONT_CHAT_ID=replace_me_with_front_chat_id

